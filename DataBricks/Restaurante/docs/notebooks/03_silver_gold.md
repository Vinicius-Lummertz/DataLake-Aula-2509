# Notebook: Silver-Gold.py

**Propósito:** Transformar os dados limpos da camada Silver em um modelo dimensional (Star Schema) otimizado para análise.

## Ações Executadas

1.  **Leitura da Camada Silver**
    * Lê as tabelas `silver.*` e as registra como Temp Views (ex: `vendas_silver`) para facilitar o uso de SQL.

2.  **Criação das Dimensões**
    * Cria as tabelas de dimensão (`dim_franquia`, `dim_profissional`, `dim_cardapio`) no schema `gold`.
    * Usa `BIGINT GENERATED BY DEFAULT AS IDENTITY` para criar chaves primárias.
    * Cria uma `dim_tempo` completa usando a função `sequence(to_date('2023-01-01'), ...)` para gerar um calendário.

3.  **Carga das Dimensões (SCD Tipo 1)**
    * Usa o comando `MERGE INTO` para popular as dimensões.
    * **WHEN MATCHED**: Atualiza os registros existentes (SCD Tipo 1).
    * **WHEN NOT MATCHED**: Insere novos registros.

4.  **Criação e Carga da Tabela Fato**
    * Cria a tabela `gold.fato_vendas` com as colunas de chave estrangeira (FKs) e as métricas (`QUANTIDADE`, `VALOR_TOTAL`).
    * Executa `TRUNCATE TABLE` para limpar a fato antes de recarregar (estratégia de recarga completa).
    * Insere os dados na `fato_vendas` fazendo `JOIN` com as dimensões para obter as chaves corretas.